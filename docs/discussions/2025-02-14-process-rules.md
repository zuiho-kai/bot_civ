# 流程规则：禁止打包 + 强制记录 — 规则制定详细记录

**日期**：2025-02-14
**议题**：改进辩论流程，避免打包讨论和记录缺失
**参与者**：用户、架构师
**流程**：用户发现问题 → 制定新规则

---

## 背景和需求

用户在回顾之前的技术栈辩论时，发现了两个严重问题：

**问题1：打包讨论导致决策不独立**
- 之前的辩论将前端框架和后端框架捆绑在一起讨论
- 导致决策相互影响，不够独立
- 例如：选择了FastAPI后，可能倾向于选择某个特定的前端框架

**问题2：辩论记录不完整**
- 之前的辩论只记录了结论，没有记录详细过程
- 无法回溯为什么做出某个决策
- 无法学习和改进辩论流程

---

## 新增规则

### 规则1：禁止打包讨论

**定义**：不同维度的决策必须拆开独立辩论

**适用场景**：
- 前端框架 vs 后端框架 → 必须分开
- 数据库选型 vs 缓存选型 → 必须分开
- 架构模式 vs 部署方式 → 必须分开

**例外情况**：
- 如果两个决策有强依赖关系，可以一起讨论
- 例如：选择React后，讨论状态管理方案（Redux vs Zustand）

**执行方式**：
- 架构师在发起辩论前，必须检查是否存在打包讨论
- 如果发现打包，必须拆分成多个独立辩论
- 用户可以随时指出打包问题，要求重新辩论

---

### 规则2：辩论记录必须可见

**定义**：每轮辩论的详细内容必须完整写入讨论记录

**必须记录的内容**：
1. 辩论背景和需求
2. 三方立场陈述（完整论点）
3. 交叉质疑与回应（完整对话）
4. 投票结果和理由
5. 最终决策和原因
6. 被否决的方案和原因

**记录格式**：
- 使用markdown格式
- 存储在 `docs/discussions/YYYY-MM-DD-主题.md`
- 在 `docs/discussions.md` 中添加索引

**记录时机**：
- 辩论结束后立即记录
- 不能拖延到下次会话

---

## 为什么需要这些规则？

### 禁止打包讨论的原因

**1. 避免决策相互影响**
- 前端和后端是独立的技术栈，应该独立评估
- 打包讨论可能导致"因为选了A，所以必须选B"的错误逻辑

**2. 提高辩论质量**
- 每个辩论聚焦单一问题，论点更清晰
- 避免辩论者分散注意力

**3. 便于后续调整**
- 如果某个决策需要调整，不会影响其他决策
- 例如：后端换框架，不影响前端

---

### 强制记录的原因

**1. 知识沉淀**
- 辩论过程包含大量有价值的思考
- 记录下来可以供后续参考

**2. 决策可追溯**
- 当决策出现问题时，可以回溯原因
- 避免"当时为什么这样选"的困惑

**3. 流程改进**
- 通过回顾辩论记录，可以发现流程问题
- 持续改进辩论质量

**4. 团队协作**
- 新成员可以通过阅读记录快速了解项目历史
- 避免重复讨论相同问题

---

## 实施细节

### 如何检测打包讨论？

**检查清单**：
- [ ] 辩论主题是否包含"和"、"以及"等连接词？
- [ ] 辩论涉及的技术栈是否属于不同层次？
- [ ] 如果拆分成两个辩论，是否仍然可以独立决策？

**示例**：
- ❌ "前端框架和后端框架选型" → 打包讨论
- ✅ "前端框架选型" + "后端框架选型" → 独立讨论
- ❌ "数据库和缓存选型" → 打包讨论
- ✅ "数据库选型" + "缓存选型" → 独立讨论

---

### 如何确保记录完整？

**记录模板**：
```markdown
# [主题] — [类型]详细记录

**日期**：YYYY-MM-DD
**议题**：一句话描述
**参与者**：列出参与角色
**流程**：辩论/协作融合/用户直接决策

---

## 背景和需求
(why this discussion happened)

## 讨论过程
(detailed arguments, proposals, voting)

## 投票/决策结果
(final decision and why)

## 下一步行动
(what to do next)
```

**质量检查**：
- 记录完成后，架构师必须检查是否包含所有必要内容
- 用户可以随时要求补充记录

---

## 下一步行动

1. ✅ 将此规则写入 `CLAUDE.md`
2. ✅ 回顾之前的技术栈辩论，按新规则重新辩论
3. ✅ 为所有历史辩论补充详细记录
4. 在后续辩论中严格执行这两条规则

---

## 关键决策点

- ✅ 禁止打包讨论，不同维度必须拆开
- ✅ 辩论记录必须完整可见
- ✅ 记录格式使用markdown
- ✅ 记录存储在 `docs/discussions/` 目录
- ✅ 架构师负责检查是否打包和记录是否完整
