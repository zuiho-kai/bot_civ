# R1 脑暴纪要 — M6.3 议题 1：四维属性 + 食物差异化

> 日期：2026-02-20
> 阶段：M6.3 阶段 0 五方脑暴
> 参与：Architect / Tech Lead / QA Lead / Developer / Human Proxy PM

---

## 议题 1：四维属性系统（P1）+ 食物差异化（P4）

### 背景

当前系统三维属性（satiety/mood/stamina），缺少精力（energy）维度。只有一种进食 action（eat_food 消耗 flour）。IR 草稿提出：
- P1：新增 energy 字段，形成四维属性系统，属性间耦合产生决策权衡
- P4：eat_food 拆分为 eat_flour（主饱腹）和 eat_fruit（主精力心情）

### 各角色观点

- **Architect**（有条件支持）：方向正确，数据模型用四个独立字段（不做 agent_attributes 表，避免过度设计）。建议 P4 拆 Phase — M6.3 只做 eat_flour，fruit 留后续。关注 fruit 生产链是否同步就绪。
  论据：食物差异化需要 fruit 有来源，否则是纸面设计；生产链+经济平衡+UI 三重风险叠加。

- **Tech Lead**（有条件支持）：技术实现简单，改造点清晰。发现 stamina 零和问题（工作-15 + 自然恢复+15 = 永远满值）。建议所有数值提取到 config，新增 AttributeChangeLog 便于调试。
  论据：stamina 自然恢复 +15 与工作消耗 -15 抵消，体力永远不会低于阈值，失去设计意义。

- **QA Lead**（有条件支持）：验收标准只覆盖 30% 场景。测试矩阵 5^4=625 种状态组合。需要补充边界条件 AC（负值保护、溢出截断、结算顺序、存量迁移）。建议补充生存曲线测试。
  论据：四维耦合可能产生死亡螺旋（饿→心情差→产能低→更穷→更饿），需要数值平衡验证。

- **Developer**（有条件支持）：实现复杂度被低估，属性耦合逻辑会散落多处。建议集中管理耦合逻辑（check_attribute_constraints 纯函数）。eat_food 建议保留统一入口加 food_type 参数。建议渐进式实施。
  论据：拆两个独立函数改动面大、漏改风险高；统一入口加参数只改 1 处。

- **Human Proxy PM**（有条件支持）：方向与用户愿景高度对齐，直击"无自主消费动机"痛点。关注 LLM 能否理解四维属性做合理决策、行为趋同风险、前端可观测性。
  论据：用户核心洞察是"Agent 行为响应实时世界状态产生连锁反应"，四维耦合正是基础设施。

### ⚠️ 少数派/附加条件

1. **Architect 独立观点**：P4 应拆 Phase，M6.3 只做 eat_flour，fruit 留后续。其他四方未明确反对但也未支持。
2. **Tech Lead 独立观点**：energy 可以先加字段但暂不启用（等副业系统上线）。与 IR 草稿"M6.3 全做"冲突。
3. **Developer 独立观点**：eat_food 保留统一入口加参数，不拆两个函数。与 IR 草稿"废弃 eat_food"冲突。

### 结论

5/5 有条件支持。全员认可四维属性方向，分歧集中在实施节奏和实现方式。

### 共识项

1. 四维属性方向正确，新增 energy 字段（5/5 一致）
2. 数据模型用四个独立字段，不做 agent_attributes 表（5/5 一致）
3. 所有数值走 config 可热调整（5/5 一致）
4. 属性耦合逻辑集中管理，不散落各处（4/5，Architect/Tech Lead/Developer/QA 明确提出）
5. 属性上下限保护：不允许负值、恢复不超 100（QA 提出，无人反对）
6. 验收标准需要大幅补充（QA 提出 10+ 条补充 AC，无人反对）
7. 每日结算顺序需要明确定义（QA 提出，无人反对）

### 分歧项（待用户拍板）

**DC-1：eat_food 拆分方式**
- 方案 A（IR 草稿）：废弃 eat_food，新建 eat_flour + eat_fruit 两个独立 action
- 方案 B（Developer）：保留 eat_food 统一入口，加 food_type 参数
- 利弊：A 语义清晰但改动面大；B 改动小但 LLM 需要理解参数

**DC-2：P4 食物差异化的实施时机**
- 方案 A（IR 草稿）：P1+P4 同期做，M6.3 一次交付
- 方案 B（Architect/QA）：P1 先做，P4 延后（fruit 生产链未就绪，风险叠加）
- 利弊：A 一步到位但风险高；B 渐进但需要两次改 eat 逻辑

**DC-3：stamina 自然恢复数值**
- 方案 A（IR 草稿）：+15（与工作消耗 -15 抵消，体力永远满值）
- 方案 B（Tech Lead）：改为 +10，制造体力缺口
- 利弊：A 简单但体力维度失去意义；B 增加生存压力但需要更多食物补充

**DC-4：发言是否消耗精力**
- 方案 A（IR 草稿）：发言 -1 精力
- 方案 B（Architect）：取消发言消耗，只保留副业/LLM 决策消耗
- 利弊：A 增加发言成本可能抑制社交；B 简化模型但精力缺少日常消耗场景

**DC-5：energy 启用时机**
- 方案 A（IR 草稿）：M6.3 直接启用，与副业系统同期
- 方案 B（Tech Lead）：先加字段但暂不启用，等副业系统上线
- 利弊：A 一步到位；B 降低风险但 energy 字段暂时无用

---

## 用户拍板结果（2026-02-21）

| 编号 | 决策项 | 拍板结果 | 备注 |
|------|--------|---------|------|
| DC-1 | eat_food 拆分方式 | **保留 eat_food 统一入口（食谱概念）**，内部选食物类型 | 预留自定义食谱扩展；不是 Developer 的"加参数简化改动"思路，而是产品层面"使用食谱"的概念 |
| DC-2 | P4 实施时机 | **同期做**，fruit 来源只有采集（不建果园），采集量给大 | Architect 拆 Phase 建议被否决；fruit 不需要果园建筑，采集即可获得 |
| DC-3 | stamina 自然恢复 | **与饱腹度挂钩**（用户自定义方案，否决 A/B 两方案） | 85+→+30, 75-84→+15, 50-74→+10, 30-49→+5, 0-29→+2（兜底）。吃饱才能恢复体力，饿了几乎不恢复。采集 fruit 不设体力门槛作为自救通道 |
| DC-4 | 发言消耗精力 | **聊天群发言免费，游戏内正式发言消耗精力** | 参考 CIVITAS2 演讲机制；社交是核心玩法不应加成本。具体消耗值和"游戏内发言"定义留 SR 细化 |
| DC-5 | energy 启用时机 | **M6.3 直接启用** | 有消耗场景（副业采集+游戏内发言），无需暂缓 |

### 对 IR 草稿的修订要求

基于拍板结果，IR 草稿需要修订以下内容：

1. **P1 stamina 恢复机制**：从固定 +15 改为饱腹度分档恢复表（5 档）
2. **P1 耦合关系新增**：satiety → stamina 恢复量的正相关耦合
3. **P1 自救通道**：采集类 action 不设体力门槛（或极低 ≥5）
4. **P4 eat_food 设计**：保留 eat_food 统一入口 + food_type 参数，概念为"食谱"
5. **P4 fruit 来源**：只有采集，不建果园，采集量调大
6. **P1 energy 消耗场景**：发言消耗拆分为聊天群（免费）和游戏内正式发言（消耗精力）
